var VEditor=function(t,e,o){"use strict";function i(t){i.installed||(i.installed=!0,t.component("VEditor",l))}e=e&&e.hasOwnProperty("default")?e.default:e,o=o&&o.hasOwnProperty("default")?o.default:o;var n={debug:!1,onchangeTimeout:200,menus:["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","image","table","code","undo","redo"]};!function(){if("undefined"!=typeof document){var t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style"),o=".v-editor { position: relative; } .v-editor .text-box { margin: 10px 0; line-height: 1.5; } .v-editor .disabled-mask { position: absolute; background-color: rgba(0,0,0,0); margin: 0; top: 0; right: 0; bottom: 0; left: 0; z-index: 2000; cursor: not-allowed; } .v-editor .loading-mask { position: absolute; background-color: rgba(0,0,0,0.3); margin: 0; top: 0; right: 0; bottom: 0; left: 0; z-index: 2000; } .v-editor .loading-mask .loading-content { position: absolute; text-align: center; width: 100%; top: 50%; margin-top: -21px; } ";e.type="text/css",e.styleSheet?e.styleSheet.cssText=o:e.appendChild(document.createTextNode(o)),t.appendChild(e)}}();var a=/^<[a-z].*>$/i,d=function(t){return t&&a.test(t)?t:'<div class="text-box">'+t+"<br></div>"},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"v-editor"},[t.showLoading?o("div",{staticClass:"loading-mask"},[o("div",{staticClass:"loading-content"},[t._t("loading",[o("p",[t._v("文件上传中...")])])],2)]):t._e(),t._v(" "),o("div",{ref:"editor",staticStyle:{"text-align":"left"}}),t._v(" "),o("upload-to-ali",t._b({directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"uploadToAli",attrs:{multiple:"multiple"},on:{loading:t.handleLoading,loaded:t.handleUploadFileSuccess}},"upload-to-ali",t.uploadOptions,!1))],1)},staticRenderFns:[],name:"VEditor",components:{UploadToAli:o},props:{uploadOptions:{type:Object,default:function(){return{}}},value:{type:String,default:function(){return""}},editorOptions:{type:Object,default:function(){return n}},height:{type:Number,default:400},disabled:{type:Boolean,default:!1}},data:function(){return{enableUpdateValue:!0,showLoading:!1}},watch:{disabled:function(t,e){document.querySelector(".w-e-toolbar").style["pointer-events"]=t?"none":"",this.editor.$textElem.attr("contenteditable",!t)},value:function(t,e){this.enableUpdateValue&&this.editor&&this.editor.$textElem.html(d(t))}},mounted:function(){var t=this,o=new e(this.$refs.editor);o.customConfig.qiniu=!0,o.customConfig.menus=this.editorOptions.menus||n.menus,o.customConfig.debug=this.editorOptions.debug,o.customConfig.zIndex=100,o.customConfig.onchangeTimeout=this.editorOptions.onchangeTimeout||n.onchangeTimeout,o.customConfig.onchange=function(e){var i=o&&o.$textElem[0].textContent.trim()?e:"";t.$emit("input",i)},o.customConfig.onfocus=function(e){t.enableUpdateValue=!1},o.customConfig.onblur=function(e){t.enableUpdateValue=!0},o.create(),o.txt.html(d(this.value)),document.querySelector(".w-e-toolbar").style["pointer-events"]=this.disabled?"none":"",o.$textElem.attr("contenteditable",!this.disabled),document.querySelector(".w-e-text-container").style.height=this.height+"px",document.getElementById(o.imgMenuId).addEventListener("click",this.handleUpload),this.editor=o},methods:{getEditor:function(){return this.editor},handleUpload:function(){this.disabled||this.$refs.uploadToAli.selectFiles()},handleLoading:function(){this.showLoading=!0,this.$emit("upload-loading",!0)},handleUploadFileSuccess:function(t){var e=this;t?t.forEach(function(t){e.editor.cmd.do("insertHtml",'<img src="'+t+'" style="max-width:100%;"/>')}):this.$emit("upload-error"),this.showLoading=!1,this.$emit("upload-loading",!1)}}},s={install:i},u=null;return"undefined"!=typeof window?u=window.Vue:"undefined"!=typeof global&&(u=global.Vue),u&&u.use(s),t.install=i,t.default=l,t}({},E,UploadToAli);
