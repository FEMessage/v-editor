var VEditor=function(e,t,o){"use strict";function n(e){n.installed||(n.installed=!0,e.component("VEditor",a))}t=t&&t.hasOwnProperty("default")?t.default:t,o=o&&o.hasOwnProperty("default")?o.default:o;var i={debug:!1,onchangeTimeout:200,menus:["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","image","table","code","undo","redo"]};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),o=".v-editor { position: relative; } .v-editor .disabled-mask { position: absolute; background-color: rgba(0,0,0,0); margin: 0; top: 0; right: 0; bottom: 0; left: 0; z-index: 2000; cursor: not-allowed; } .v-editor .loading-mask { position: absolute; background-color: rgba(0,0,0,0.3); margin: 0; top: 0; right: 0; bottom: 0; left: 0; z-index: 2000; } .v-editor .loading-mask .loading-content { position: absolute; text-align: center; width: 100%; top: 50%; margin-top: -21px; } ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=o:t.appendChild(document.createTextNode(o)),e.appendChild(t)}}();var a={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"v-editor"},[e.showLoading?o("div",{staticClass:"loading-mask"},[o("div",{staticClass:"loading-content"},[e._t("loading",[o("p",[e._v("文件上传中...")])])],2)]):e._e(),e._v(" "),o("div",{ref:"editor",staticStyle:{"text-align":"left"}}),e._v(" "),o("upload-to-ali",e._b({directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"uploadToAli",attrs:{multiple:"multiple"},on:{loading:e.handleLoading,loaded:e.handleUploadFileSuccess}},"upload-to-ali",e.uploadOptions,!1))],1)},staticRenderFns:[],name:"VEditor",components:{UploadToAli:o},props:{uploadOptions:{type:Object,default:function(){return{}}},value:{type:String,default:function(){return""}},editorOptions:{type:Object,default:function(){return i}},height:{type:Number,default:400},disabled:{type:Boolean,default:!1}},data:function(){return{enableUpdateValue:!0,showLoading:!1}},watch:{disabled:function(e,t){document.querySelector(".w-e-toolbar").style["pointer-events"]=e?"none":"",this.editor.$textElem.attr("contenteditable",!e)},value:function(e,t){this.enableUpdateValue&&this.editor&&this.editor.$textElem.html(e)}},mounted:function(){var e=this,o=new t(this.$refs.editor);o.customConfig.qiniu=!0,o.customConfig.menus=this.editorOptions.menus||i.menus,o.customConfig.debug=this.editorOptions.debug,o.customConfig.zIndex=100,o.customConfig.onchangeTimeout=this.editorOptions.onchangeTimeout||i.onchangeTimeout,o.customConfig.onchange=function(t){e.$emit("input",t)},o.customConfig.onfocus=function(t){e.enableUpdateValue=!1},o.customConfig.onblur=function(t){e.enableUpdateValue=!0},o.create(),o.txt.html(this.value),document.querySelector(".w-e-toolbar").style["pointer-events"]=this.disabled?"none":"",o.$textElem.attr("contenteditable",!this.disabled),document.querySelector(".w-e-text-container").style.height=this.height+"px",document.getElementById(o.imgMenuId).addEventListener("click",this.handleUpload),this.editor=o},methods:{getEditor:function(){return this.editor},handleUpload:function(){this.disabled||this.$refs.uploadToAli.selectFiles()},handleLoading:function(){this.showLoading=!0,this.$emit("upload-loading",!0)},handleUploadFileSuccess:function(e){var t=this;e?e.forEach(function(e){t.editor.cmd.do("insertHtml",'<img src="'+e+'" style="max-width:100%;"/>')}):this.$emit("upload-error"),this.showLoading=!1,this.$emit("upload-loading",!1)}}},d={install:n},l=null;return"undefined"!=typeof window?l=window.Vue:"undefined"!=typeof global&&(l=global.Vue),l&&l.use(d),e.install=n,e.default=a,e}({},E,UploadToAli);
