// 基础功能组件
import Plugin from '@ckeditor/ckeditor5-core/src/plugin'
// 按钮视图组件
import ButtonView from '@ckeditor/ckeditor5-ui/src/button/buttonview'

// 按钮的图标 SVG
const iconFull = `<svg t="1579398696513" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1413" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20">
  <defs><style type="text/css"></style></defs>
  <path d="M639.328 416c8.032 0 16.096-3.008 22.304-9.056l202.624-197.184-0.8 143.808c-0.096 17.696 14.144 32.096 31.808 32.192 0.064 0 0.128 0 0.192 0 17.6 0 31.904-14.208 32-31.808l1.248-222.208c0-0.672-0.352-1.248-0.384-1.92 0.032-0.512 0.288-0.896 0.288-1.408 0.032-17.664-14.272-32-31.968-32.032L671.552 96l-0.032 0c-17.664 0-31.968 14.304-32 31.968C639.488 145.632 653.824 160 671.488 160l151.872 0.224-206.368 200.8c-12.672 12.32-12.928 32.608-0.64 45.248C622.656 412.736 630.976 416 639.328 416zM896.032 639.552 896.032 639.552c-17.696 0-32 14.304-32.032 31.968l-0.224 151.872-200.832-206.4c-12.32-12.64-32.576-12.96-45.248-0.64-12.672 12.352-12.928 32.608-0.64 45.248l197.184 202.624-143.808-0.8c-0.064 0-0.128 0-0.192 0-17.6 0-31.904 14.208-32 31.808-0.096 17.696 14.144 32.096 31.808 32.192l222.24 1.248c0.064 0 0.128 0 0.192 0 0.64 0 1.12-0.32 1.76-0.352 0.512 0.032 0.896 0.288 1.408 0.288l0.032 0c17.664 0 31.968-14.304 32-31.968L928 671.584C928.032 653.952 913.728 639.584 896.032 639.552zM209.76 159.744l143.808 0.8c0.064 0 0.128 0 0.192 0 17.6 0 31.904-14.208 32-31.808 0.096-17.696-14.144-32.096-31.808-32.192L131.68 95.328c-0.064 0-0.128 0-0.192 0-0.672 0-1.248 0.352-1.888 0.384-0.448 0-0.8-0.256-1.248-0.256 0 0-0.032 0-0.032 0-17.664 0-31.968 14.304-32 31.968L96 352.448c-0.032 17.664 14.272 32 31.968 32.032 0 0 0.032 0 0.032 0 17.664 0 31.968-14.304 32-31.968l0.224-151.936 200.832 206.4c6.272 6.464 14.624 9.696 22.944 9.696 8.032 0 16.096-3.008 22.304-9.056 12.672-12.32 12.96-32.608 0.64-45.248L209.76 159.744zM362.368 617.056l-202.624 197.184 0.8-143.808c0.096-17.696-14.144-32.096-31.808-32.192-0.064 0-0.128 0-0.192 0-17.6 0-31.904 14.208-32 31.808l-1.248 222.24c0 0.704 0.352 1.312 0.384 2.016 0 0.448-0.256 0.832-0.256 1.312-0.032 17.664 14.272 32 31.968 32.032L352.448 928c0 0 0.032 0 0.032 0 17.664 0 31.968-14.304 32-31.968s-14.272-32-31.968-32.032l-151.936-0.224 206.4-200.832c12.672-12.352 12.96-32.608 0.64-45.248S375.008 604.704 362.368 617.056z" p-id="1414"></path>
</svg>
`

const iconResize = `<svg t="1580718016587" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3334" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs><style type="text/css"></style></defs>
  <path d="M416 560H224a48 48 0 1 0 0 96h76.112L61.488 894.624l0.048 0.048A47.84 47.84 0 0 0 48 928a48 48 0 0 0 48 48c12.96 0 24.688-5.2 33.312-13.568l0.048 0.064L368 723.888V800a48 48 0 1 0 96 0V608a48 48 0 0 0-48-48z m192-96h192a48 48 0 1 0 0-96h-76.112L962.512 129.376l-0.048-0.048C970.816 120.688 976 108.96 976 96a48 48 0 0 0-48-48c-12.976 0-24.688 5.2-33.328 13.552l-0.048-0.048L656 300.128V224a48 48 0 1 0-96 0v192a48 48 0 0 0 48 48z m354.512 430.624L723.888 656H800a48 48 0 1 0 0-96H608a48 48 0 0 0-48 48v192a48 48 0 1 0 96 0v-76.112l238.624 238.624 0.048-0.048c8.64 8.352 20.352 13.536 33.328 13.536a48 48 0 0 0 48-48c0-12.976-5.2-24.688-13.568-33.328l0.08-0.048zM416 176a48 48 0 0 0-48 48v76.112L129.376 61.488l-0.048 0.064A47.824 47.824 0 0 0 96 48a48 48 0 0 0-48 48c0 12.96 5.2 24.688 13.552 33.312l-0.064 0.064L300.112 368H224a48 48 0 1 0 0 96h192a48 48 0 0 0 48-48V224a48 48 0 0 0-48-48z" fill="" p-id="3335"></path>
</svg>
`

// 自定义组件需要继承基础组件
export default class FullScreen extends Plugin {
  // 重写基础组件的初始化函数
  init() {
    const {editor} = this
    // 将自定义按钮添加到当前编辑器的组件工厂
    editor.ui.componentFactory.add('fullScreen', locale => {
      // 获取当前编辑器的按钮视图
      const view = new ButtonView(locale)

      // 在按钮视图中注入自定义按钮的名称、图标
      view.set({
        label: '切换全屏',
        icon: iconFull,
        // 开启提示，当鼠标悬浮到按钮上，会显示 label 指定的 fullscreen 字样
        tooltip: true
      })

      // 点击按钮
      view.on('execute', e => {
        e.source.icon = editor.ui.view.element.classList.contains('full-screen')
          ? iconFull
          : iconResize
        // ckeditor 是挂载在传入 dom 后面的，有意思
        editor.ui.view.element.classList.toggle('full-screen')
      })

      // 返回修改后的视图内容
      return view
    })
  }
}
