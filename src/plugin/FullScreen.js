// 基础功能组件
import Plugin from '@ckeditor/ckeditor5-core/src/plugin'
// 按钮视图组件
import ButtonView from '@ckeditor/ckeditor5-ui/src/button/buttonview'

// 按钮的图标 SVG
const iconFull = `<svg t="1579398696513" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1413" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20">
  <path d="M639.328 416c8.032 0 16.096-3.008 22.304-9.056l202.624-197.184-0.8 143.808c-0.096 17.696 14.144 32.096 31.808 32.192 0.064 0 0.128 0 0.192 0 17.6 0 31.904-14.208 32-31.808l1.248-222.208c0-0.672-0.352-1.248-0.384-1.92 0.032-0.512 0.288-0.896 0.288-1.408 0.032-17.664-14.272-32-31.968-32.032L671.552 96l-0.032 0c-17.664 0-31.968 14.304-32 31.968C639.488 145.632 653.824 160 671.488 160l151.872 0.224-206.368 200.8c-12.672 12.32-12.928 32.608-0.64 45.248C622.656 412.736 630.976 416 639.328 416zM896.032 639.552 896.032 639.552c-17.696 0-32 14.304-32.032 31.968l-0.224 151.872-200.832-206.4c-12.32-12.64-32.576-12.96-45.248-0.64-12.672 12.352-12.928 32.608-0.64 45.248l197.184 202.624-143.808-0.8c-0.064 0-0.128 0-0.192 0-17.6 0-31.904 14.208-32 31.808-0.096 17.696 14.144 32.096 31.808 32.192l222.24 1.248c0.064 0 0.128 0 0.192 0 0.64 0 1.12-0.32 1.76-0.352 0.512 0.032 0.896 0.288 1.408 0.288l0.032 0c17.664 0 31.968-14.304 32-31.968L928 671.584C928.032 653.952 913.728 639.584 896.032 639.552zM209.76 159.744l143.808 0.8c0.064 0 0.128 0 0.192 0 17.6 0 31.904-14.208 32-31.808 0.096-17.696-14.144-32.096-31.808-32.192L131.68 95.328c-0.064 0-0.128 0-0.192 0-0.672 0-1.248 0.352-1.888 0.384-0.448 0-0.8-0.256-1.248-0.256 0 0-0.032 0-0.032 0-17.664 0-31.968 14.304-32 31.968L96 352.448c-0.032 17.664 14.272 32 31.968 32.032 0 0 0.032 0 0.032 0 17.664 0 31.968-14.304 32-31.968l0.224-151.936 200.832 206.4c6.272 6.464 14.624 9.696 22.944 9.696 8.032 0 16.096-3.008 22.304-9.056 12.672-12.32 12.96-32.608 0.64-45.248L209.76 159.744zM362.368 617.056l-202.624 197.184 0.8-143.808c0.096-17.696-14.144-32.096-31.808-32.192-0.064 0-0.128 0-0.192 0-17.6 0-31.904 14.208-32 31.808l-1.248 222.24c0 0.704 0.352 1.312 0.384 2.016 0 0.448-0.256 0.832-0.256 1.312-0.032 17.664 14.272 32 31.968 32.032L352.448 928c0 0 0.032 0 0.032 0 17.664 0 31.968-14.304 32-31.968s-14.272-32-31.968-32.032l-151.936-0.224 206.4-200.832c12.672-12.352 12.96-32.608 0.64-45.248S375.008 604.704 362.368 617.056z" p-id="1414"></path>
</svg>
`

const iconResize = `<svg t="1580719405422" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2393" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <path d="M392.70731752 116.4921875c21.9770482 0 39.79057872 17.86623348 39.79057871 39.73787575v230.78535688c0 28.09056773-16.86488108 44.90274584-45.008151 44.90274585H156.33546918A39.84328168 39.84328168 0 0 1 116.4921875 392.23299319c0-21.92434524 17.91893644-39.73787575 39.84328168-39.73787654H298.31668676L127.92868523 182.37062916a38.4730101 38.4730101 0 0 1 0-54.38924174 39.36895657 39.36895657 0 0 1 54.60005204 0l170.22989342 170.12448827V156.28276622A39.94868683 39.94868683 0 0 1 392.70731752 116.4921875z m278.0070245 39.79057872v141.77040651l170.22989265-170.07178531a39.36895657 39.36895657 0 0 1 54.60005281 0 38.4730101 38.4730101 0 0 1 0 54.38924174l-170.38800152 170.0717853h142.03392053c21.9770482 0 39.84328168 17.81353051 39.84328091 39.73787576 0 21.87164229-17.91893644 39.68517356-39.84328091 39.68517357H636.03592965c-28.19597287 0-45.008151-16.81217812-45.00815099-44.90274585V156.28276622a39.79057872 39.79057872 0 0 1 79.68656336 0z m-317.90300837 710.96014246v-141.87581165l-170.22989342 170.12448749a39.36895657 39.36895657 0 0 1-54.60005281 0 38.4730101 38.4730101 0 0 1 0-54.38924098l170.38800152-170.0717853H156.33546918A39.84328168 39.84328168 0 0 1 116.4921875 631.29268248c0-21.87164229 17.91893644-39.68517356 39.84328168-39.68517356h231.15427606c28.19597287 0 45.008151 16.81217812 45.00815099 44.90274585v230.83805983a39.79057872 39.79057872 0 0 1-79.68656258-0.15810811z m278.00702373 39.73787653a39.79057872 39.79057872 0 0 1-39.79057872-39.73787653V636.4575518c0-28.09056773 16.86488108-44.90274584 45.00815099-44.90274585h231.15427684c21.9770482 0 39.84328168 17.81353051 39.8432809 39.73787653 0 21.87164229-17.91893644 39.68517356-39.8432809 39.68517279H725.20898892l170.38800152 170.07178532a38.4730101 38.4730101 0 0 1 0 54.38924173 39.36895657 39.36895657 0 0 1-54.60005281 0l-170.22989342-170.12448826v141.82310947c0 21.9770482-17.91893644 39.84328168-39.89598387 39.84328168z" p-id="2394"></path>
</svg>
`

// 自定义组件需要继承基础组件
export default class FullScreen extends Plugin {
  // 重写基础组件的初始化函数
  init() {
    const {editor} = this
    // 将自定义按钮添加到当前编辑器的组件工厂
    editor.ui.componentFactory.add('fullScreen', locale => {
      // 获取当前编辑器的按钮视图
      const view = new ButtonView(locale)

      // 在按钮视图中注入自定义按钮的名称、图标
      view.set({
        label: '切换全屏',
        icon: iconFull,
        // 开启提示，当鼠标悬浮到按钮上，会显示 label 指定的 fullscreen 字样
        tooltip: true
      })

      // 点击按钮
      view.on('execute', e => {
        e.source.icon = editor.ui.view.element.classList.contains('full-screen')
          ? iconFull
          : iconResize
        // ckeditor 是挂载在传入 dom 后面的，有意思
        editor.ui.view.element.classList.toggle('full-screen')
      })

      // 返回修改后的视图内容
      return view
    })
  }
}
